import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# Building metadata and annual summary statistics
building_id = 105
primary_use = 'Education'
square_feet = 50623
yearly_mean_kwh = 78.12403
yearly_min_kwh = 23.3036
yearly_max_kwh = 173.945
summer_mean_kwh = 78.177864
winter_mean_kwh = 76.68618

# Generate a list of 48 hours' worth of time intervals
hours = pd.date_range(start='01-01-2016', periods=48, freq='H')

# Create an empty DataFrame to store the electricity consumption data
electricity_data = pd.DataFrame(columns=['DATE', 'VALUE'])

# Loop through each hour and generate a random electricity value between yearly_min_kwh and yearly_max_kwh
for i, hour in enumerate(hours):
    date_str = (hour - timedelta(hours=i)).strftime('%Y-%m-%d %H:%M')
    
    # Generate random values consistent with the summary stats
    if pd.to_datetime(hour).month in [6, 7, 8]:  # Summer months
        value = np.random.normal(summer_mean_kwh, yearly_max_kwh - summer_mean_kwh) + summer_mean_kwh
        value = max(yearly_min_kwh, min(value, yearly_max_kwh))
    else:  # Winter months
        value = np.random.normal(winter_mean_kwh, yearly_max_kwh - winter_mean_kwh) + winter_mean_kwh
        value = max(yearly_min_kwh, min(value, yearly_max_kwh))

    electricity_data.loc[len(electricity_data.index)] = [date_str, round(value, 5)]

# Print the generated electricity consumption data
for index, row in electricity_data.iterrows():
    print(f"{row['DATE']}, {row['VALUE']}")