import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Set seed for reproducibility
np.random.seed(0)

# Building metadata and annual summary statistics
building_id = 105
primary_use = 'Education'
square_feet = 50623
yearly_mean_kwh = 78.12403
yearly_min_kwh = 23.3036
yearly_max_kwh = 173.945
summer_mean_kwh = 78.177864
winter_mean_kwh = 76.68618

# Generate dates for the first 72 hours
start_date = datetime(2016, 1, 1)
dates = [start_date + timedelta(hours=i) for i in range(7200)]

# Initialize a DataFrame to hold the generated data
data = pd.DataFrame({'DATE': dates, 'VALUE': np.random.uniform(yearly_min_kwh, yearly_max_kwh, size=len(dates))})

# Ensure values are within the specified ranges
data['VALUE'] = np.clip(data['VALUE'], yearly_min_kwh, yearly_max_kwh)

# Apply seasonal adjustments
seasons = ['summer', 'winter']
current_season_index = 0
for i in range(len(dates)):
    month = dates[i].month
    if (dates[i].year == 2016 and 6 <= month <= 8) or \
       (dates[i].year == 2016 and 12 >= month >= 2):
        current_season_index += 1
    data.loc[i, 'VALUE'] = np.random.uniform(yearly_mean_kwh * season_adjustment(current_season_index), yearly_mean_kwh * season_adjustment(current_season_index))

# Function to apply seasonal adjustment factor
def season_adjustment(season_index):
    if season_index == 0:
        return 1.01 # close to summer_mean_kwh
    elif season_index == 1:
        return 1.00 # close to winter_mean_kwh
    else:
        return 1.00

# Print the generated data
for index, row in data.iterrows():
    print(f"{row['DATE'].strftime('%Y-%m-%d %H:%M')}, {row['VALUE']:.6f}")