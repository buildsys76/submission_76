import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Set random seed for reproducibility
np.random.seed(0)

# Generate dates
start_date = '2016-01-01'
end_date = start_date + str(pd.Timedelta(days=144))

dates = [start_date + pd.Timedelta(days=i) for i in range(1, 145)]

# Initialize an empty DataFrame with kWh values
df = pd.DataFrame({'Date': dates, 'kWh': np.nan})

# Set a time step of 1 hour
hourly_step = pd.Timedelta(hours=1)

# Interpolate between the mean and min/max to create a more realistic distribution
df['kWh'] = (df['kWh'].interpolate(method='linear', limit_direction='both')) * ((df['kWh'].min() - df['kWh'].mean()) / (df['kWh'].max() - df['kWh'].mean())) + df['kWh'].mean()

# Apply a seasonal factor to create a more realistic distribution
seasonal_factor = np.where((pd.to_datetime(df['Date']) >= pd.to_datetime('2016-06-01')) & 
                          (pd.to_datetime(df['Date']) <= pd.to_datetime('2016-08-31')), df['kWh'].mean(), 
                          np.where((pd.to_datetime(df['Date']) >= pd.to_datetime('2016-12-01')) & 
                                  (pd.to_datetime(df['Date']) <= pd.to_datetime('2017-02-28')), df['kWh'].mean(), 1))

df = df.assign(kWh=df['kWh'] * seasonal_factor)

# Ensure values are within the min and max limits
df.loc[df['kWh'] < yearly_min_kwh, 'kWh'] = yearly_min_kwh
df.loc[df['kWh'] > yearly_max_kwh, 'kWh'] = yearly_max_kwh

print(df[['Date', 'kWh']].to_string(index=False))