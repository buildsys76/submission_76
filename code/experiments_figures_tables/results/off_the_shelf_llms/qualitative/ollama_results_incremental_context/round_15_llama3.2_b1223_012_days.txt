import random
from datetime import datetime, timedelta

# Define constants
year = 2016
num_measurements = 288
monthly_length = 31 # approximate length of a month ( Jan, Feb, Mar etc)
seasonal_mean = {
    'summer': 81.22173,
    'winter': 83.83176
}

def generate_dataset():
    # Define start and end dates
    start_date = datetime(year, 1, 1)
    end_date = start_date + timedelta(days=num_measurements)

    # Initialize output list
    dataset = []

    # Generate electricity consumption data for each hour
    current_date = start_date
    while current_date <= end_date:
        month_start_date = None

        if (current_date.month == 3 and current_date.day >= 21) or \
           (current_date.month == 6 and current_date.day >= 1) or \
           (current_date.month == 9 and current_date.day >= 1) or \
           (current_date.month == 12 and current_date.day >= 1):
            month_start_date = datetime(year, current_date.month, 1)

        if month_start_date is None:
            hourly_mean = yearley_mean_kwh
        elif (current_date.month == 3 and current_date.day < 21) or \
             (current_date.month == 6 and current_date.day < 1) or \
             (current_date.month == 9 and current_date.day < 1) or \
             (current_date.month == 12 and current_date.day <= 31):
            hourly_mean = seasonal_mean['summer']
        else:
            hourly_mean = seasonal_mean['winter']

        # Generate a random value within the specified range
        consumption = round(random.uniform(yearly_min_kwh, yearly_max_kwh), 3)

        # Ensure that values are realistic and consistent with summary stats
        if consumption < yearly_min_kwh:
            consumption = yearly_min_kwh
        elif consumption > yearly_max_kwh:
            consumption = yearly_max_kwh

        dataset.append(f"{current_date.strftime('%Y-%m-%d %H:%M')},{consumption}")

        # Move to the next day
        if current_date.month < 12:
            current_date += timedelta(days=1)
        elif current_date.month == 12 and current_date.day <= 31:
            current_date += timedelta(days=31)
        else:
            current_date += timedelta(days=30)

    return dataset

yearly_mean_kwh = 76.72134
yearley_min_kwh = 0.0
yearley_max_kwh = 174.64

# Generate electricity consumption data for each hour
dataset = generate_dataset()

print('\n'.join(dataset))