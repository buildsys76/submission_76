import pandas as pd
import numpy as np

# Set seed for reproducibility
np.random.seed(42)

# Define constants
building_id = 1073
primary_use = 'Office'
square_feet = 194111
yearly_mean_kwh = 179.21414
yearly_min_kwh = 0.0
yearly_max_kwh = 853.0
summer_mean_kwh = 118.158516
winter_mean_kwh = 230.26053
num_measurements = 168

# Generate a date range for the measurements
start_date = pd.to_datetime('2016-01-01')
end_date = start_date + pd.Timedelta(days=num_measurements * 24)
date_range = pd.date_range(start=start_date, end=end_date, freq='H')

# Create a list to store the data
data = []

# Loop over each date in the range
for i, dt in enumerate(date_range):
    # Check if it's summer or winter based on month
    if (dt.month >= 6 and dt.month <= 8) or (dt.month >= 12 and dt.month <= 2):
        # Summer months average around summer_mean_kwh
        consumption = np.random.normal(summer_mean_kwh, yearly_max_kwh - summer_mean_kwh)
    else:
        # Winter months average around winter_mean_kwh
        consumption = np.random.normal(winter_mean_kwh, yearly_max_kwh - winter_mean_kwh)

    # Ensure value is within valid range
    consumption = max(yearly_min_kwh, min(consumption, yearly_max_kwh))

    # Add data to list with timestamp and consumption value
    data.append(f"{dt.strftime('%Y-%m-%d %H:%M')},{consumption:.8f}")

# Join all data into a single string with newline characters in between
output = '\n'.join(data)

print(output)