import random
from datetime import datetime, timedelta

# Summary statistics
yearly_mean_kwh = 17.38018
yearly_min_kwh = 0.8
yearly_max_kwh = 74.32
summer_mean_kwh = 25.539513
winter_mean_kwh = 11.742976

# Generate date range
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=720)

# Initialize list to store measurements
measurements = []

# Loop through each hour in the date range
for n in range(int((end_date - start_date).days)):
    # Calculate current date and time
    current_time = start_date + timedelta(days=n)
    current_datetime = current_time.strftime("%Y-%m-%d %H:%M")

    # Randomly choose between summer and winter mean kWh based on month
    if (current_datetime.month == 6 or current_datetime.month == 7 or current_datetime.month == 8):
        mean_kwh = summer_mean_kwh
    elif (current_datetime.month in [12, 1, 2]):
        mean_kwh = winter_mean_kwh

    # Generate random deviation around mean kWh
    deviation = round(random.uniform(-0.5, 0.5), 4)

    # Ensure value stays within min and max kWh
    kwh_value = max(min(mean_kwh + deviation, yearly_max_kwh),
                    max(mean_kwh - deviation, yearly_min_kwh))

    measurements.append(f"{current_datetime}, {kwh_value}")

# Output the generated dataset
print("\n".join(measurements))