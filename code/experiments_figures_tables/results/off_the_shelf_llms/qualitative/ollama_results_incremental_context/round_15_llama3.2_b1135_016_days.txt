import pandas as pd
from datetime import timedelta, date

# Define building metadata and annual summary statistics (2016)
building_id = 1135
primary_use = "Education"
square_feet = 150393
yearly_mean_kwh = 263.43817
yearly_min_kwh = 125.06
yearly_max_kwh = 479.897
summer_mean_kwh = 263.8639
winter_mean_kwh = 250.41924

# Define the start and end dates for generating electricity consumption data
start_date = date(2016, 1, 1)
end_date = pd.Timestamp('2020-12-31')
time_interval = timedelta(hours=1)

# Initialize an empty list to store the generated data
data = []

# Generate electricity consumption data at 1-hour intervals for exactly 384 measurements
for n in range(384):
    current_date = start_date + n * time_interval
    
    # Calculate the average kWh value based on the seasonal mean or yearly mean depending on the month
    if (current_date.month >= 6 and current_date.month <= 8) or (current_date.month >= 12 and current_date.month <= 2):
        avg_kwh = summer_mean_kwh
    else:
        avg_kwh = yearly_mean_kwh
    
    # Generate a random value within the allowed range to make it more realistic
    kwh_value = round(avg_kwh + (yearly_max_kwh - yearly_min_kwh) * (n / 383), 6)
    
    # Ensure that the generated value does not exceed the maximum or minimum values
    if kwh_value < yearly_min_kwh:
        kwh_value = yearly_min_kwh
    elif kwh_value > yearly_max_kwh:
        kwh_value = yearly_max_kwh
    
    # Append the generated data to the list
    data.append(f"{current_date.strftime('%Y-%m-%d %H:%M')}, {kwh_value}")

# Print the full dataset
for line in data:
    print(line)