import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# Set seed for reproducibility
np.random.seed(42)

# Define building metadata
building_id = 1086
primary_use = "Office"
square_feet = 143973
yearly_mean_kwh = 296.72125
yearly_min_kwh = 85.275
yearly_max_kwh = 595.904
summer_mean_kwh = 393.1739
winter_mean_kwh = 218.81273

# Generate dates and intervals
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=408*24) # 408 measurements at 1-hour interval
dates = [start_date + timedelta(hours=i) for i in range(408)]

# Initialize lists to store the values
values = []

# Loop over dates and generate random values
for date in dates:
    if date.month in [6,7,8]: # Summer months
        value = np.random.normal(summer_mean_kwh, yearly_min_kwh/4)  # Average around summer_mean_kwh with some variation
    else: # Winter months
        value = np.random.normal(winter_mean_kwh, yearly_min_kwh/4)
        
    # Ensure values are within the valid range
    value = max(yearly_min_kwh, min(value, yearly_max_kwh))
    
    # Add value to list
    values.append(value)

# Convert lists to pandas Series and DataFrame
values = pd.Series(values, index=dates)
df = values.to_frame('kWh')

# Print output
for index, row in df.iterrows():
    print(f"{index.strftime('%Y-%m-%d %H:%M')}, {row['kWh']:.8f}")