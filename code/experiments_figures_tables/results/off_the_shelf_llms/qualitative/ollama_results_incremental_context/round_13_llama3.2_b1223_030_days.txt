import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# Define the building metadata and statistics
building_metadata = {
    'building_id': 1223,
    'primary_use': 'Office',
    'square_feet': 52141,
    'yearly_mean_kwh': 76.72134,
    'yearly_min_kwh': 0.0,
    'yearly_max_kwh': 174.64,
    'summer_mean_kwh': 81.22173,
    'winter_mean_kwh': 83.83176
}

# Generate the date range for 720 measurements
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=719)

# Initialize lists to store the date and value data
date_data = []
value_data = []

# Loop through each day in the specified range
for i in range(int((end_date - start_date).days)):
    # Generate a date for this measurement
    current_date = start_date + timedelta(days=i)
    
    # Calculate the hour of the day for this measurement
    hour_of_day = (current_date.hour % 24) / 24
    
    # Randomly generate values that are consistent with the yearly statistics
    if current_date.month in [6, 7, 8]:
        value = np.random.uniform(75, 85)
    elif current_date.month in [12, 1, 2]:
        value = np.random.uniform(80, 90)
    else:
        value = np.random.uniform(60, 80)
        
    # Make sure the generated value is within the valid range
    while value < building_metadata['yearly_min_kwh'] or value > building_metadata['yearly_max_kwh']:
        if current_date.month in [6, 7, 8]:
            value = np.random.uniform(75, 85)
        elif current_date.month in [12, 1, 2]:
            value = np.random.uniform(80, 90)
        else:
            value = np.random.uniform(60, 80)

    # Append the date and value to their respective lists
    date_data.append(current_date.strftime('%Y-%m-%d %H:%M'))
    value_data.append(value)

# Create a dataframe from the date and value data
df = pd.DataFrame({'Date': date_data, 'Value (kWh)': value_data})

# Print the dataframe in the desired format
for index, row in df.iterrows():
    print(f"{row['Date']}, {row['Value (kWh)']}")