import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Define building metadata and annual summary statistics
building_metadata = {
    'building_id': 1073,
    'primary_use': 'Office',
    'square_feet': 194111,
    'yearly_mean_kwh': 179.21414,
    'yearly_min_kwh': 0.0,
    'yearly_max_kwh': 853.0,
    'summer_mean_kwh': 118.158516,
    'winter_mean_kwh': 230.26053
}

# Define start and end dates for the dataset
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=143)  # Adjusted to account for exact 144 measurements

# Initialize a list to store the dataset
dataset = []

# Generate electricity consumption data at 1-hour intervals
for i in range(int((end_date - start_date).days)):
    current_date = start_date + timedelta(days=i)
    
    if (current_date.month >= 6) and (current_date.month <= 8):
        # Summer month, generate values around summer_mean_kwh
        value = np.random.normal(building_metadata['summer_mean_kwh'], building_metadata['yearly_max_kwh'] / 10)
        value = max(building_metadata['yearly_min_kwh'], min(value, building_metadata['yearly_max_kwh']))
    elif (current_date.month >= 12) and (current_date.month <= 2):
        # Winter month, generate values around winter_mean_kwh
        value = np.random.normal(building_metadata['winter_mean_kwh'], building_metadata['yearly_max_kwh'] / 10)
        value = max(building_metadata['yearly_min_kwh'], min(value, building_metadata['yearly_max_kwh']))
    else:
        # Other months, generate values around yearly_mean_kwh
        value = np.random.normal(building_metadata['yearly_mean_kwh'], building_metadata['yearly_max_kwh'] / 10)
        value = max(building_metadata['yearly_min_kwh'], min(value, building_metadata['yearly_max_kwh']))
    
    # Append the generated value and date to the dataset
    dataset.append(f"{current_date.strftime('%Y-%m-%d %H:%M')}, {value:.4f}")

# Print the dataset
print("\n".join(dataset))