import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# Building metadata and annual summary statistics (2016)
building_id = 1073
primary_use = "Office"
square_feet = 194111
yearly_mean_kwh = 179.21414
yearly_min_kwh = 0.0
yearly_max_kwh = 853.0
summer_mean_kwh = 118.158516
winter_mean_kwh = 230.26053

# Generate electricity consumption data (kWh) at 1-hour intervals,
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=600)
date_list = [start_date + timedelta(days=i) for i in range(600)]
consumption_values = []

for date in date_list:
    # Determine if the month is summer or winter
    if (date.month == 6 or date.month == 7 or date.month == 8):
        mean_kwh = summer_mean_kwh
    elif (date.month == 12 or date.month == 1 or date.month == 2):
        mean_kwh = winter_mean_kwh
    else:
        # If it's not summer or winter, the consumption is constant at yearly_mean_kwh
        mean_kwh = yearly_mean_kwh

    # Generate a random value close to the mean_kwh
    kwh_consumption = round(np.random.uniform(mean_kwh - 0.1*mean_kwh, mean_kwh + 0.1*mean_kwh),2)

    if kwh_consumption < yearly_min_kwh:
        kwh_consumption = yearly_min_kwh

    elif kwh_consumption > yearly_max_kwh:
        kwh_consumption = yearly_max_kwh

    consumption_values.append(kwh_consumption)

# Combine date and consumption value
data = list(zip(date_list, consumption_values))

# Format as required
formatted_data = []
for d, c in data:
    formatted_date = d.strftime('%Y-%m-%d %H:%M')
    formatted_value = str(c)
    formatted_data.append(f"{formatted_date},{formatted_value}")

print('\n'.join(formatted_data))