import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import random

# Define constants
BUILDING_ID = 272
PRIMARY_USE = 'Education'
SQUARE_FOOTAGE = 4583
YEARLY_MEAN_KWH = 17.38018
YEARLY_MIN_KWH = 0.8
YEARLY_MAX_KWH = 74.32
SUMMER_MEAN_KWH = 25.539513
WINTER_MEAN_KWH = 11.742976

# Initialize list to store readings
readings = []

# Generate data for each hour in the dataset
for i in range(456):
    # Calculate date and time for current reading
    date = datetime(2016, 1 + (i // 24), 1)
    time = timedelta(hours=i % 24)

    # Randomly select whether it's summer or winter based on day of year
    if (date.month == 6 or date.month == 7 or date.month == 8) and \
       not (date.month == 12 and date.day > 25):
        mean_kwh = SUMMER_MEAN_KWH
    elif (date.month == 12 and date.day >= 26) and \
         not ((date.month == 6 or date.month == 7 or date.month == 8) and 
              date.day <= 25):
        mean_kwh = WINTER_MEAN_KWH
    else:
        # If it's neither summer nor winter, use yearly mean kWh
        mean_kwh = YEARLY_MEAN_KWH

    # Generate random value around mean kWh that is within min and max limits
    kwh = round(mean_kwh + (random.uniform(-mean_kwh, mean_kwh) * 0.1), 3)

    # Ensure reading doesn't go below yearly_min_kwh or above yearly_max_kwh
    if kwh < YEARLY_MIN_KWH:
        kwh = YEARLY_MIN_KWH
    elif kwh > YEARLY_MAX_KWH:
        kwh = YEARLY_MAX_KWH

    # Append reading to list
    readings.append((date.strftime('%Y-%m-%d %H:%M'), kwh))

# Print the readings in the required format
for reading in readings:
    print(f"{reading[0]}, {reading[1]}")