import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# Building metadata and annual summary statistics (2016)
building_id = 1246
primary_use = "Office"
square_feet = 50327
yearly_mean_kwh = 46.317394
yearly_min_kwh = 0.0
yearly_max_kwh = 82.0
summer_mean_kwh = 42.024456
winter_mean_kwh = 46.382324

# Generate electricity consumption data (kWh) at 1-hour intervals,
# starting on 01 January 2016, for exactly 720 measurements.
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=730 - 2) # last day before Jan 2024
time_interval = timedelta(hours=1)

data = []
current_date = start_date

while current_date < end_date:
    if (current_date.month in [6,7,8]) or (current_date.month == 12 and current_date.day >= 22):
        mean_kwh = summer_mean_kwh
    elif (current_date.month in [12,1,2]) or (current_date.month == 3 and current_date.day >= 15):
        mean_kwh = winter_mean_kwh
    else:
        mean_kwh = yearly_mean_kwh
    
    # Randomly vary the value by 10% around the mean to simulate real-world usage patterns
    value = round(mean_kwh * (1 + np.random.uniform(-0.1, 0.1)), 3)
    
    # Ensure values are within valid range
    if value < yearly_min_kwh:
        value = yearly_min_kwh
    elif value > yearly_max_kwh:
        value = yearly_max_kwh

    data.append((current_date.strftime('%Y-%m-%d %H:%M'), value))
    current_date += time_interval

# Output the full dataset
for row in data:
    print(f"{row[0]},{row[1]}")