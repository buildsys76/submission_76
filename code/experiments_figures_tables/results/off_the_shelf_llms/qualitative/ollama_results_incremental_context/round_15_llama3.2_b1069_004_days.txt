import pandas as pd
import numpy as np

# Set random seed for reproducibility
np.random.seed(42)

# Building metadata and annual summary statistics (2016)
building_id = 1069
primary_use = "Office"
square_feet = 20864
yearly_mean_kwh = 6.4528236
yearly_min_kwh = 0.0
yearly_max_kwh = 18.1
summer_mean_kwh = 6.342618
winter_mean_kwh = 6.7815933

# Generate dates and hours for 96 measurements, starting on January 1st, 2016
start_date = pd.to_datetime('2016-01-01')
dates = pd.date_range(start=start_date, periods=96)
hours = np.arange(0, 96)

# Split the data into summer (June-Aug) and winter (Dec-Feb) months
summer_dates = dates[(dates.month >= 6) & (dates.month <= 8)]
winter_dates = dates[(dates.month >= 12) & (dates.month <= 2)]

# Generate values for each date, following the constraints:
values = np.random.uniform(yearly_min_kwh, yearly_max_kwh, size=96)

# For summer months, average around summer_mean_kwh
summer_values = [np.random.normal(summer_mean_kwh, yearly_max_kwh - summer_mean_kwh) for _ in range(len(summer_dates))]
for i, value in enumerate(summer_values):
    values[i] += (value > 0.9 * sum(summer_values)) and value < 1.1 * sum(summer_values)

# For winter months, average around winter_mean_kwh
winter_values = [np.random.normal(winter_mean_kwh, yearly_max_kwh - winter_mean_kwh) for _ in range(len(winter_dates))]
for i, value in enumerate(winter_values):
    values[i] += (value > 0.9 * sum(winter_values)) and value < 1.1 * sum(winter_values)

# Print the generated electricity consumption data
for date, hour, value in zip(dates, hours, values):
    print(f"{date.strftime('%Y-%m-%d')} {hour:02d},{value:.6f}")