import random
from datetime import datetime, timedelta

# Building metadata
building_id = 11
primary_use = "Education"
square_feet = 49073
yearly_mean_kwh = 296.39252
yearly_min_kwh = 0.0
yearly_max_kwh = 1052.0
summer_mean_kwh = 486.43784
winter_mean_kwh = 162.72496

# Generate electricity consumption data
def generate_data(start_date, end_date):
    current_date = start_date
    while current_date <= end_date:
        # Calculate daily average based on the season
        if (current_date.month >= 6 and current_date.month <= 8) or (current_date.month >= 12 and current_date.month <= 2):
            kwh = summer_mean_kwh
        else:
            kwh = yearly_mean_kwh
        
        # Randomly adjust values to mimic real-world usage patterns
        adjustment = random.uniform(-0.1, 0.1) * yearly_mean_kwh
        kwh += adjustment

        # Ensure values are within the allowed range
        if current_date.month >= 6 and current_date.month <= 8 or current_date.month >= 12 and current_date.month <= 2:
            value = max(0, min(kwh, summer_mean_kwh))
        else:
            value = max(0, min(kwh, yearly_mean_kwh))

        yield f"{current_date.strftime('%Y-%m-%d %H:%M')},{value:.4f}\n"
        
        # Move to the next day
        if current_date.month != 12 or (current_date.month == 12 and current_date.day > 31):
            current_date += timedelta(days=1)
        else:
            current_date = datetime(current_date.year + 1, 1, 1)

# Generate data for 24 hours starting from January 1st
start_date = "2016-01-01"
end_date = "2016-01-25"

data = generate_data(start_date, end_date)
print(data)