import pandas as pd
from datetime import timedelta, datetime

# Set seed for reproducibility
pd.seed(0)

# Define constants
BUILDING_ID = 107
PRIMARY_USE = "Education"
SQUARE_FEET = 97532
YEARLY_MEAN_KWH = 234.75676
YEARLY_MIN_KWH = 0.0405
YEARLY_MAX_KWH = 591.0
SUMMER_MEAN_KWH = 212.6387
WINTER_MEAN_KWH = 265.17035

# Generate datetime object for start of 2016
start_date = datetime(2016, 1, 1)

# Initialize list to store electricity consumption data
data = []

# Loop through each hour in the year
for i in range(int((365*24)/696)):
    date = start_date + timedelta(hours=i)
    
    # Randomly select a value between yearly_min_kwh and yearly_max_kwh, weighted towards 
    # yearly_mean_kwh for most values (80% chance), and towards winter_mean_kwh or summer_mean_kwh
    # depending on the month (20%)
    if date.month in [12, 1, 2]:  # Winter months (Dec-Feb)
        kwh = WINTER_MEAN_KWH + (YEARLY_MEAN_KWH - WINTER_MEAN_KWH) * 0.2 + \
             ((pd.to_datetime(date).dayofyear % 30) / 29) * (WINTER_MEAN_KWH - YEARLY_MEAN_KWH)
    elif date.month in [6, 7, 8]:  # Summer months (Jun-Aug)
        kwh = SUMMER_MEAN_KWH + (YEARLY_MEAN_KWH - SUMMER_MEAN_KWH) * 0.2 + \
             ((pd.to_datetime(date).dayofyear % 30) / 29) * (SUMMER_MEAN_KWH - YEARLY_MEAN_KWH)
    else:  
        kwh = YEARLY_MEAN_KWH + (YEARLY_MEAN_KWH - WINTER_MEAN_KWH) * 0.2 + \
             ((pd.to_datetime(date).dayofyear % 30) / 29) * (WINTER_MEAN_KWH - YEARLY_MEAN_KWH)
    if kwh < YEARLY_MIN_KWH:
        kwh = YEARLY_MIN_KWH
    elif kwh > YEARLY_MAX_KWH:
        kwh = YEARLY_MAX_KWH

    data.append((date.strftime('%Y-%m-%d %H:%M'), round(kwh, 5)))

# Convert list of tuples to a DataFrame and print it
import pandas as pd

df = pd.DataFrame(data, columns=['Date', 'kWh'])
print(df)