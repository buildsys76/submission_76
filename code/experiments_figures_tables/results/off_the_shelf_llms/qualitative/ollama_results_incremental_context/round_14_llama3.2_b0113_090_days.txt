import pandas as pd
import numpy as np
from datetime import timedelta, date

# Building metadata
building_id = 113
primary_use = "Education"
square_feet = 100481
yearly_mean_kwh = 363.97446
yearly_min_kwh = 159.643
yearly_max_kwh = 679.25
summer_mean_kwh = 365.49576
winter_mean_kwh = 361.4717

# Generate date range for 2160 measurements
start_date = date(2016, 1, 1)
end_date = start_date + timedelta(days=2160 - 1)

# Initialize lists to store data and timestamps
timestamps = []
values = []

# Function to generate random kwh values within the given ranges
def gen_random_kwh(min_value, max_value):
    return round(np.random.uniform(min_value, max_value), 3)

# Generate data for each hour in the specified range
for n in range(int((end_date - start_date).days) + 1):
    current_date = start_date + timedelta(days=n)
    
    # Determine season based on month (0-11)
    if current_date.month in [6, 7, 8]: # June, July, August
        avg_kwh = summer_mean_kwh
    elif current_date.month in [12, 1, 2]: # December, January, February
        avg_kwh = winter_mean_kwh
    else:
        avg_kwh = yearly_mean_kwh
        
    kwh = gen_random_kwh(avg_kwh - (avg_kwh * 0.05), avg_kwh + (avg_kwh * 0.05)) # Random variation of Â±5%
    
    # Ensure value stays within range
    if kwh < yearly_min_kwh:
        kwh = yearly_min_kwh
    elif kwh > yearly_max_kwh:
        kwh = yearly_max_kwh
    
    timestamps.append(current_date.strftime("%Y-%m-%d %H:%M"))
    values.append(kwh)

# Combine data into a single list of lines
lines = [f"{timestamp},{value}" for timestamp, value in zip(timestamps, values)]

print("\n".join(lines))