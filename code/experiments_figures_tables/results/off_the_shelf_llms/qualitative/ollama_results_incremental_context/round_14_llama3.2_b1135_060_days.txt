import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Initial setup
start_date = pd.to_datetime('01 January 2016')
end_date = start_date + timedelta(days=1440)

building_metadata = {
    'yearly_mean_kwh': 263.43817,
    'yearly_min_kwh': 125.06,
    'yearly_max_kwh': 479.897,
    'summer_mean_kwh': 263.8639,
    'winter_mean_kwh': 250.41924
}

current_date = start_date

# Function to generate the dataset
def generate_dataset():
    global current_date, building_metadata
    
    # Create empty DataFrame to hold data
    df = pd.DataFrame(columns=['DATE', 'VALUE'])
    
    for _ in range(1440):
        daily_mean_kwh = round(building_metadata['yearly_mean_kwh'], 3)
        
        date_str = current_date.strftime('%Y-%m-%d')
        value = daily_mean_kwh + np.random.normal(loc=0, scale=(building_metadata['summer_mean_kwh'] - building_metadata['winter_mean_kwh'])/2)
        value = round(min(max(value, building_metadata['yearly_min_kwh']), building_metadata['yearly_max_kwh']), 3)

        df = pd.concat([df, pd.DataFrame({'DATE': [date_str], 'VALUE': [value]})])
        
        # Move to next day
        if current_date.month == 12 and current_date.day > 31:
            break

        if current_date.month != 2 or (current_date.month == 2 and current_date.year % 4 == 0) or \
           (current_date.month == 2 and current_date.year % 400 == 0):
            # February has 29 days
            current_date = current_date + timedelta(days=1)
        else:
            # Other months have 30 days
            current_date = current_date + timedelta(days=1)
    
    return df

df = generate_dataset()
print(df.to_string(index=False))