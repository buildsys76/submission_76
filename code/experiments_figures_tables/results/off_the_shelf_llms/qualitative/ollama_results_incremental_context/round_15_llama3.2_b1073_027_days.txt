import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Set a seed for reproducibility
np.random.seed(42)

# Building metadata and annual summary statistics (2016)
building_metadata = {
    'building_id': 1073,
    'primary_use': 'Office',
    'square_feet': 194111,
    'yearly_mean_kwh': 179.21414,
    'yearly_min_kwh': 0.0,
    'yearly_max_kwh': 853.0,
    'summer_mean_kwh': 118.158516,
    'winter_mean_kwh': 230.26053
}

# Generate date range from 01 January 2016 to 31 December 2016 (648 days)
start_date = pd.to_datetime('2016-01-01')
end_date = start_date + timedelta(days=647)

# Initialize list to store electricity consumption data
data = []

# Loop over each hour in the date range
for i in range((end_date - start_date).days):
    # Convert current date to datetime object
    current_date = start_date + timedelta(days=i)
    
    # Randomly select between summer and winter mean kWh based on month
    if (current_date.month > 5) or (current_date.month < 3):  
        kwh = np.random.normal(building_metadata['summer_mean_kwh'], building_metadata['yearly_mean_kwh'] / 12)
    else:
        kwh = np.random.normal(building_metadata['winter_mean_kwh'], building_metadata['yearly_mean_kwh'] / 6)

    # Ensure kWh value is within the valid range
    if kwh < building_metadata['yearly_min_kwh']:
        kwh = building_metadata['yearly_min_kwh']
    elif kwh > building_metadata['yearly_max_kwh']:
        kwh = building_metadata['yearly_max_kwh']

    # Append current date and kWh value to the data list
    data.append(f'{current_date.strftime("%Y-%m-%d %H:%M")},{kwh:.10f}')

# Print the electricity consumption data (648 lines)
for line in data:
    print(line)