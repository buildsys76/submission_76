import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Building metadata and annual summary statistics (2016)
building_metadata = {
    'building_id': 11,
    'primary_use': 'Education',
    'square_feet': 49073,
    'yearly_mean_kwh': 296.39252,
    'yearly_min_kwh': 0.0,
    'yearly_max_kwh': 1052.0,
    'summer_mean_kwh': 486.43784,
    'winter_mean_kwh': 162.72496
}

# Generate electricity consumption data (kWh) at 1-hour intervals,
# starting on 01 January 2016, for exactly 3600 measurements.
df = pd.DataFrame({'Date': [], 'Value': []})
start_date = datetime(2016, 1, 1)
current_date = start_date

for _ in range(3600):
    date = current_date.strftime('%Y-%m-%d %H:%M')
    value = np.random.uniform(building_metadata['yearly_min_kwh'], building_metadata['yearly_max_kwh'])
    
    # Ensure values are within the summer and winter ranges
    if current_date.month in [6, 7, 8]:
        value = np.random.uniform(building_metadata['summer_mean_kwh'] * 0.9, building_metadata['summer_mean_kwh'] * 1.1)
    elif current_date.month in [12, 1, 2]:
        value = np.random.uniform(building_metadata['winter_mean_kwh'] * 0.9, building_metadata['winter_mean_kwh'] * 1.1)

    df.loc[len(df)] = (date, round(value, 3))

    # Increment date by one hour
    current_date += timedelta(hours=1)

# Convert to desired output format
df_output = ''
for _, row in df.iterrows():
    year, month, day, hour, value = row[0].split(' ')[0], row[0].split(' ')[1], row[0].split(' ')[2], row[0].split(' ')[3], int(row[1])
    date_str = f"{year}-{month:02d}-{day:02d} {hour}:{value:06.0f}"
    df_output += f"{date_str},\n"

print(df_output[:-2])  # Remove the trailing comma and newline