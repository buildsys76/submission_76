import random
from datetime import datetime, timedelta

# Building metadata and annual summary statistics (2016)
building_id = 107
primary_use = 'Education'
square_feet = 97532
yearly_mean_kwh = 234.75676
yearly_min_kwh = 0.0405
yearly_max_kwh = 591.0
summer_mean_kwh = 212.6387
winter_mean_kwh = 265.17035

# Generate electricity consumption data (kWh) at 1-hour intervals,
# starting on 01 January 2016, for exactly 504 measurements.
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=365*2)

for n in range(0, 504):
    date = start_date + timedelta(seconds=n*3600)
    day_type = 'Summer' if (date.month >= 6 and date.month <= 8) else 'Winter'

    if day_type == 'Summer':
        avg_kwh = summer_mean_kwh
    elif day_type == 'Winter':
        avg_kwh = winter_mean_kwh

    kwh_value = round(random.gauss(avg_kwh, yearly_min_kwh/10), 3)
    # Ensuring output value stays within valid range [yearly_min_kwh, yearly_max_kwh]
    if kwh_value > yearly_max_kwh:
        kwh_value = yearly_max_kwh
    elif kwh_value < yearly_min_kwh:
        kwh_value = yearly_min_kwh

    print(f"{date.strftime('%Y-%m-%d %H:%M')}, {kwh_value}")