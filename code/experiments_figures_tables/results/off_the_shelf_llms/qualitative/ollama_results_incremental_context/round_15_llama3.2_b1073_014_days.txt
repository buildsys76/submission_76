import pandas as pd
from datetime import datetime, timedelta
import numpy as np

# Building metadata and annual summary statistics (2016)
building_id = 1073
primary_use = 'Office'
square_feet = 194111
yearly_mean_kwh = 179.21414
yearly_min_kwh = 0.0
yearly_max_kwh = 853.0
summer_mean_kwh = 118.158516
winter_mean_kwh = 230.26053

# Initialize lists to store the time and electricity consumption values
time_values = []
electricity_values = []

# Generate electricity consumption data (kWh) at 1-hour intervals,
# starting on 01 January 2016, for exactly 336 measurements.
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=365*336)

for n in range(int((end_date - start_date).days)):
    time_value = start_date + timedelta(n)
    if (time_value.month in [6,7,8]) and (time_value.day >= 1) and (time_value.day <= 31):
        avg_value = summer_mean_kwh
    elif (time_value.month in [12,1,2]) and (time_value.day >= 1) and (time_value.day <= 28):
        avg_value = winter_mean_kwh
    else:
        avg_value = yearly_mean_kwh

    # Randomly introduce some noise to the data
    value = avg_value + np.random.normal(0, yearly_max_kwh/10000)
    
    # Ensure values do not go below min or above max
    if value < yearly_min_kwh:
        value = yearly_min_kwh
    elif value > yearly_max_kwh:
        value = yearly_max_kwh

    time_values.append(str(time_value))
    electricity_values.append(round(value, 4))

# Create the final dataset
dataset = '\n'.join(f"{time_value},{electricity_value}" for time_value,electricity_value in zip(time_values, electricity_values))

print(dataset)