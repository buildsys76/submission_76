import pandas as pd
import numpy as np
from datetime import timedelta, datetime

# Building metadata and annual summary statistics (2016)
building_id = 105
primary_use = 'Education'
square_feet = 50623
yearly_mean_kwh = 78.12403
yearly_min_kwh = 23.3036
yearly_max_kwh = 173.945
summer_mean_kwh = 78.177864
winter_mean_kwh = 76.68618

# Generate electricity consumption data (kWh) at 1-hour intervals,
start_date = datetime(2016, 1, 1)
end_date = start_date + timedelta(days=432*30)

# Initialize lists to store the data
dates = []
values = []

current_date = start_date
while current_date <= end_date:
    for i in range(-1, 2):
        hour_value = (i+1)%24
        if year == 2016 and month in [6,7,8] or year == 2016 and month in [12,1,2]:
            # Summer months average around summer_mean_kwh.
            value = summer_mean_kwh + np.random.normal(0,summer_mean_kwh*0.01)
        else:
            if year == 2016 and month in [12,1,2]:
                # Winter months average around winter_mean_kwh
                value = winter_mean_kwh + np.random.normal(0,winter_mean_kwh*0.01)
            elif primary_use == 'Education':
                # Most values should be near yearly_mean_kwh.
                value = yearly_mean_kwh * 1.05 + np.random.normal(0,yearly_mean_kwh*0.03)
            else:
                value = 0 
        if value < yearly_min_kwh or value > yearly_max_kwh:   
            value = yearly_min_kwh or yearly_max_kwh
        values.append(value)
        dates.append(current_date.strftime('%Y-%m-%d %H:%M'))
    current_date += timedelta(hours=1)

print('\n'.join(f'{date},{value}' for date, value in zip(dates, values)))